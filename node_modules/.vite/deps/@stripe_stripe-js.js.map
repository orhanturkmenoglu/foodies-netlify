{"version":3,"file":"@stripe_stripe-js.js","names":["runtimeVersionToUrlVersion","isStripeJSURL","findScript","injectScript","registerWrapper","onError","onLoad","loadScript","initStripe","getStripePromise","loadStripe"],"sources":["../../@stripe/stripe-js/dist/index.mjs"],"sourcesContent":["var RELEASE_TRAIN = 'clover';\n\nvar runtimeVersionToUrlVersion = function runtimeVersionToUrlVersion(version) {\n  return version === 3 ? 'v3' : version;\n};\n\nvar ORIGIN = 'https://js.stripe.com';\nvar STRIPE_JS_URL = \"\".concat(ORIGIN, \"/\").concat(RELEASE_TRAIN, \"/stripe.js\");\nvar V3_URL_REGEX = /^https:\\/\\/js\\.stripe\\.com\\/v3\\/?(\\?.*)?$/;\nvar STRIPE_JS_URL_REGEX = /^https:\\/\\/js\\.stripe\\.com\\/(v3|[a-z]+)\\/stripe\\.js(\\?.*)?$/;\nvar EXISTING_SCRIPT_MESSAGE = 'loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used';\n\nvar isStripeJSURL = function isStripeJSURL(url) {\n  return V3_URL_REGEX.test(url) || STRIPE_JS_URL_REGEX.test(url);\n};\n\nvar findScript = function findScript() {\n  var scripts = document.querySelectorAll(\"script[src^=\\\"\".concat(ORIGIN, \"\\\"]\"));\n\n  for (var i = 0; i < scripts.length; i++) {\n    var script = scripts[i];\n\n    if (!isStripeJSURL(script.src)) {\n      continue;\n    }\n\n    return script;\n  }\n\n  return null;\n};\n\nvar injectScript = function injectScript(params) {\n  var queryString = params && !params.advancedFraudSignals ? '?advancedFraudSignals=false' : '';\n  var script = document.createElement('script');\n  script.src = \"\".concat(STRIPE_JS_URL).concat(queryString);\n  var headOrBody = document.head || document.body;\n\n  if (!headOrBody) {\n    throw new Error('Expected document.body not to be null. Stripe.js requires a <body> element.');\n  }\n\n  headOrBody.appendChild(script);\n  return script;\n};\n\nvar registerWrapper = function registerWrapper(stripe, startTime) {\n  if (!stripe || !stripe._registerWrapper) {\n    return;\n  }\n\n  stripe._registerWrapper({\n    name: 'stripe-js',\n    version: \"8.0.0\",\n    startTime: startTime\n  });\n};\n\nvar stripePromise$1 = null;\nvar onErrorListener = null;\nvar onLoadListener = null;\n\nvar onError = function onError(reject) {\n  return function (cause) {\n    reject(new Error('Failed to load Stripe.js', {\n      cause: cause\n    }));\n  };\n};\n\nvar onLoad = function onLoad(resolve, reject) {\n  return function () {\n    if (window.Stripe) {\n      resolve(window.Stripe);\n    } else {\n      reject(new Error('Stripe.js not available'));\n    }\n  };\n};\n\nvar loadScript = function loadScript(params) {\n  // Ensure that we only attempt to load Stripe.js at most once\n  if (stripePromise$1 !== null) {\n    return stripePromise$1;\n  }\n\n  stripePromise$1 = new Promise(function (resolve, reject) {\n    if (typeof window === 'undefined' || typeof document === 'undefined') {\n      // Resolve to null when imported server side. This makes the module\n      // safe to import in an isomorphic code base.\n      resolve(null);\n      return;\n    }\n\n    if (window.Stripe && params) {\n      console.warn(EXISTING_SCRIPT_MESSAGE);\n    }\n\n    if (window.Stripe) {\n      resolve(window.Stripe);\n      return;\n    }\n\n    try {\n      var script = findScript();\n\n      if (script && params) {\n        console.warn(EXISTING_SCRIPT_MESSAGE);\n      } else if (!script) {\n        script = injectScript(params);\n      } else if (script && onLoadListener !== null && onErrorListener !== null) {\n        var _script$parentNode;\n\n        // remove event listeners\n        script.removeEventListener('load', onLoadListener);\n        script.removeEventListener('error', onErrorListener); // if script exists, but we are reloading due to an error,\n        // reload script to trigger 'load' event\n\n        (_script$parentNode = script.parentNode) === null || _script$parentNode === void 0 ? void 0 : _script$parentNode.removeChild(script);\n        script = injectScript(params);\n      }\n\n      onLoadListener = onLoad(resolve, reject);\n      onErrorListener = onError(reject);\n      script.addEventListener('load', onLoadListener);\n      script.addEventListener('error', onErrorListener);\n    } catch (error) {\n      reject(error);\n      return;\n    }\n  }); // Resets stripePromise on error\n\n  return stripePromise$1[\"catch\"](function (error) {\n    stripePromise$1 = null;\n    return Promise.reject(error);\n  });\n};\nvar initStripe = function initStripe(maybeStripe, args, startTime) {\n  if (maybeStripe === null) {\n    return null;\n  }\n\n  var pk = args[0];\n  var isTestKey = pk.match(/^pk_test/); // @ts-expect-error this is not publicly typed\n\n  var version = runtimeVersionToUrlVersion(maybeStripe.version);\n  var expectedVersion = RELEASE_TRAIN;\n\n  if (isTestKey && version !== expectedVersion) {\n    console.warn(\"Stripe.js@\".concat(version, \" was loaded on the page, but @stripe/stripe-js@\").concat(\"8.0.0\", \" expected Stripe.js@\").concat(expectedVersion, \". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning\"));\n  }\n\n  var stripe = maybeStripe.apply(undefined, args);\n  registerWrapper(stripe, startTime);\n  return stripe;\n}; // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n\nvar stripePromise;\nvar loadCalled = false;\n\nvar getStripePromise = function getStripePromise() {\n  if (stripePromise) {\n    return stripePromise;\n  }\n\n  stripePromise = loadScript(null)[\"catch\"](function (error) {\n    // clear cache on error\n    stripePromise = null;\n    return Promise.reject(error);\n  });\n  return stripePromise;\n}; // Execute our own script injection after a tick to give users time to do their\n// own script injection.\n\n\nPromise.resolve().then(function () {\n  return getStripePromise();\n})[\"catch\"](function (error) {\n  if (!loadCalled) {\n    console.warn(error);\n  }\n});\nvar loadStripe = function loadStripe() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  loadCalled = true;\n  var startTime = Date.now(); // if previous attempts are unsuccessful, will re-load script\n\n  return getStripePromise().then(function (maybeStripe) {\n    return initStripe(maybeStripe, args, startTime);\n  });\n};\n\nexport { loadStripe };\n"],"mappings":"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"}